<app-header></app-header>
<div class="change-password-container">
  <div class="change-password-card">
    <h2>Change Password</h2>
    <form [formGroup]="form" (ngSubmit)="submit()">
      
      <div class="form-group">
        <label for="current">Current Password</label>
        <div class="input-group">
          <input 
            [type]="showPasswords ? 'text' : 'password'" 
            formControlName="currentPassword" 
            id="current" 
            placeholder="Enter current password" />
        </div>
        <div *ngIf="f.currentPassword.touched && f.currentPassword.invalid" class="error">
          *Current password is required
        </div>
      </div>

      <div class="form-group">
        <label for="new">New Password</label>
        <div class="input-group">
          <input 
            [type]="showPasswords ? 'text' : 'password'" 
            formControlName="newPassword" 
            id="new" 
            placeholder="Enter new password"
            (input)="onPasswordInput()" />
        </div>
        
        <div class="password-instructions">
          <small [class.valid]="passwordConditions.minLength">• At least 8 characters</small>
          <small [class.valid]="passwordConditions.uppercase">• At least one uppercase letter (A-Z)</small>
          <small [class.valid]="passwordConditions.number">• At least one number (0-9)</small>
        </div>
        
        <div *ngIf="f.newPassword.touched && f.newPassword.invalid" class="error">
          *New password does not meet requirements
        </div>
      </div>

      <div class="form-group">
        <label for="confirm">Confirm New Password</label>
        <div class="input-group">
          <input 
            [type]="showPasswords ? 'text' : 'password'" 
            formControlName="confirmPassword" 
            id="confirm" 
            placeholder="Re-enter new password" />
        </div>
        <div *ngIf="form.errors?.['passwordMismatch'] && f.confirmPassword.touched" class="error">
          *New passwords don't match
        </div>
      </div>

      <div class="form-group">
        <label class="material-checkbox">
          <input 
            type="checkbox" 
            [(ngModel)]="showPasswords"
            [ngModelOptions]="{standalone: true}">
          <span class="checkmark"></span>
          Show passwords
        </label>
      </div>

      <div *ngIf="successMessage" class="success-message">{{ successMessage }}</div>

      <div *ngIf="error" class="error main-error">{{ error }}</div>
      
      <button type="submit" class="btn-save" [disabled]="form.invalid">
        Change Password
      </button>
    </form>
  </div>
</div>
